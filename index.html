<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PRISMA Research Lab</title>
  <meta name="description" content="Prisma AI Research Lab - Publications and Model Weights">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: "Courier New", Monaco, monospace;
      font-size: 14px;
      line-height: 1.6;
      background: #000;
      color: #ccc;
      min-height: 100vh;
      padding: 20px;
    }
    main.container { max-width: 900px; margin: 0 auto; }
    .ascii-header {
      text-align: center; margin: 20px 0 30px;
      white-space: pre; font-size: 11px; line-height: 1.2; color: #e87c1b;
    }
    .subtitle { text-align: center; margin: -10px 0 30px; font-size: 12px; opacity: 0.6; }
    .controls {
      position: fixed; top: 20px; right: 20px;
      display: flex; gap: 10px; z-index: 100;
    }
    .ctrl-btn, .back-link {
      background: none; border: 1px solid #e87c1b; color: #e87c1b;
      padding: 6px 12px; cursor: pointer; font-family: inherit; font-size: 11px;
      transition: all 0.2s; text-decoration: none; display: inline-block;
    }
    .ctrl-btn:focus, .back-link:focus { outline: 2px dashed #e87c1b; }
    .ctrl-btn:hover, .back-link:hover { background: #e87c1b; color: #000; }
    .tabs { display: flex; gap: 0; margin-bottom: 30px; border: 1px solid #e87c1b; }
    .tabs button {
      flex: 1; background: none; border: none; border-right: 1px solid #e87c1b;
      color: #ccc; padding: 12px; cursor: pointer; font-family: inherit; font-size: 12px;
      transition: all 0.2s;
    }
    .tabs button:last-child { border-right: none; }
    .tabs button.active, .tabs button:focus.active { background: #e87c1b; color: #000; }
    .tabs button:focus:not(.active) { background: rgba(232,124,27,0.2); }
    .tabs button:hover:not(.active) { background: rgba(232,124,27,0.1); }
    .search-bar {
      width: 100%; padding: 10px 12px; background: rgba(255,255,255,0.05);
      border: 1px solid #444; color: #ccc; font-family: inherit; font-size: 13px; margin-bottom: 20px;
    }
    .search-bar:focus { outline: none; border-color: #e87c1b; }
    .filters { display: flex; gap: 8px; margin-bottom: 30px; flex-wrap: wrap; }
    .filter-btn {
      background: none; border: 1px solid #444; color: #888; padding: 6px 12px;
      cursor: pointer; font-family: inherit; font-size: 11px; transition: all 0.2s;
    }
    .filter-btn.active { border-color: #e87c1b; color: #e87c1b; }
    .filter-btn:focus { outline: 2px dashed #e87c1b; }
    .filter-btn:hover { border-color: #e87c1b; }
    .grid { display: flex; flex-direction: column; gap: 20px; }
    .card { border: 1px solid #444; padding: 20px; background: rgba(255,255,255,0.02); transition: border-color 0.2s; }
    .card:hover { border-color: #e87c1b; }
    .card-title { font-size: 15px; font-weight: bold; color: #e87c1b; margin-bottom: 8px; }
    .card-meta { font-size: 11px; opacity: 0.6; margin-bottom: 12px; }
    .card-content { font-size: 13px; line-height: 1.7; margin-bottom: 15px; color: #aaa; }
    .tags { display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; }
    .tag { font-size: 10px; padding: 3px 8px; border: 1px solid #555; color: #888; }
    .model-info {
      display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;
      margin: 15px 0; padding: 12px; border: 1px solid #333; font-size: 11px;
    }
    .model-info-item { display: flex; flex-direction: column; gap: 3px; }
    .model-info-label { opacity: 0.5; font-size: 9px; text-transform: uppercase; }
    .model-info-value { color: #e87c1b; }
    .btn {
      display: inline-block; padding: 8px 16px; border: 1px solid #e87c1b; color: #e87c1b;
      text-decoration: none; font-size: 12px; text-align: center; transition: all 0.2s; background: none;
    }
    .btn:focus { outline: 2px dashed #e87c1b; }
    .btn:hover { background: #e87c1b; color: #000; }
    .section { display: none; }
    .section.active { display: block; }
    .loading, .empty { text-align: center; padding: 40px; opacity: 0.5; font-size: 13px; }
    .footer { text-align: center; margin-top: 60px; padding-top: 20px; border-top: 1px solid #333; font-size: 11px; opacity: 0.5; }
    .ascii-divider { text-align: center; margin: 30px 0; opacity: 0.3; font-size: 10px; }
    @media (max-width: 768px) {
      body { padding: 10px; }
      .ascii-header { font-size: 8px; }
      .controls { position: static; margin-bottom: 20px; }
      .model-info { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <nav class="controls" aria-label="Page controls">
    <a class="back-link" href="https://girishgh7.github.io/personal-Website/" aria-label="Back to main website">
      ← Back | [translate:ಹಿಂತಿರುಗಿ]
    </a>
    <button class="ctrl-btn" id="langBtn" type="button" aria-label="Toggle language">KA</button>
  </nav>
  <main class="container" role="main">
    <header>
      <div class="ascii-header" aria-hidden="true">
┌─────────────────────────────────────────────────┐
│  ██████╗ ██████╗ ██╗███████╗███╗   ███╗ █████╗  │
│  ██╔══██╗██╔══██╗██║██╔════╝████╗ ████║██╔══██╗ │
│  ██████╔╝██████╔╝██║███████╗██╔████╔██║███████║ │
│  ██╔═══╝ ██╔══██╗██║╚════██║██║╚██╔╝██║██╔══██║ │
│  ██║     ██║  ██║██║███████║██║ ╚═╝ ██║██║  ██║ │
│  ╚═╝     ╚═╝  ╚═╝╚═╝╚══════╝╚═╝     ╚═╝╚═╝  ╚═╝ │
└─────────────────────────────────────────────────┘
      </div>
      <div class="subtitle">PRISMA Research Lab | [translate:PRISMA ಸಂಶೋಧನಾ ಪ್ರಯೋಗಾಲಯ]</div>
    </header>
    <nav class="tabs" role="tablist">
      <button class="active" data-tab="pubs" data-en="Publications" data-ka="[translate:ಪ್ರಕಾಶನಗಳು]" aria-selected="true" role="tab">Publications | [translate:ಪ್ರಕಾಶನಗಳು]</button>
      <button data-tab="models" data-en="Models" data-ka="[translate:ಮಾದರಿ]" aria-selected="false" role="tab">Models | [translate:ಮಾದರಿ]</button>
    </nav>
    <section id="pubs" class="section active" role="tabpanel" aria-labelledby="publications-tab">
      <input type="text" autocomplete="off" class="search-bar" id="searchPubs"
             placeholder="search... | [translate:ಹುಡುಕಿ...]" data-en-ph="search..." data-ka-ph="[translate:ಹುಡುಕಿ...]">
      <div class="filters" id="pubFilters"></div>
      <div class="grid" id="pubsGrid">
        <div class="loading">loading... | [translate:ಲೋಡ್ ಆಗುತ್ತಿದೆ...]</div>
      </div>
    </section>
    <section id="models" class="section" role="tabpanel" aria-labelledby="models-tab">
      <input type="text" autocomplete="off" class="search-bar" id="searchModels"
             placeholder="search... | [translate:ಹುಡುಕಿ...]" data-en-ph="search..." data-ka-ph="[translate:ಹುಡುಕಿ...]">
      <div class="filters" id="modelFilters"></div>
      <div class="grid" id="modelsGrid">
        <div class="loading">loading... | [translate:ಲೋಡ್ ಆಗುತ್ತಿದೆ...]</div>
      </div>
    </section>
    <div class="ascii-divider" aria-hidden="true">──────────────</div>
    <footer class="footer" data-en="2025 Prisma Research Lab" data-ka="[translate:2025 ಪ್ರಿಸ್ಮಾ ರಿಸರ್ಚ್ ಲ್ಯಾಬ್]">
      2025 Prisma Research Lab | [translate:2025 ಪ್ರಿಸ್ಮಾ ರಿಸರ್ಚ್ ಲ್ಯಾಬ್]
    </footer>
  </main>
  <script>
    // State
    let postsData = [], modelsData = [], lang = localStorage.getItem('lang') || 'en';
    const filters = { pubs: new Set(), models: new Set() };
    const langBtn = document.getElementById('langBtn');

    function escapeHTML(str) {
      return String(str).replace(/[&<>"'`=]/g, s => ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','`':'&#96;','=':'&#61;'
      })[s]);
    }
    function applyLang(l) {
      lang = l;
      document.querySelectorAll('[data-en]').forEach(el => {
        const en = el.getAttribute('data-en') || '';
        const ka = el.getAttribute('data-ka') || '';
        el.textContent = l === 'en' ? en : ka;
      });
      document.querySelectorAll('[data-en-ph]').forEach(el => {
        const en = el.getAttribute('data-en-ph') || '';
        const ka = el.getAttribute('data-ka-ph') || '';
        el.placeholder = l === 'en' ? en : ka;
      });
      langBtn.textContent = l === 'en' ? 'KA' : 'EN';
      localStorage.setItem('lang', l);
    }
    langBtn.onclick = () => applyLang(lang === 'en' ? 'ka' : 'en');
    document.querySelectorAll('.tabs button').forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(btn.getAttribute('data-tab')).classList.add('active');
      };
    });
    async function loadContent(name) {
      try {
        const res = await fetch(`content/${escapeHTML(name)}.${lang}.txt`);
        if (!res.ok) throw new Error();
        return await res.text();
      } catch {
        try {
          const fb = await fetch(`content/${escapeHTML(name)}.en.txt`);
          if (!fb.ok) throw new Error();
          return await fb.text();
        } catch {
          return 'Content unavailable. | [translate:ವಿಷಯ ಲಭ್ಯವಿಲ್ಲ.]';
        }
      }
    }
    async function loadPosts() {
      try {
        const res = await fetch('data/posts.json');
        const json = await res.json();
        postsData = json.posts || [];
        displayPosts(postsData);
        setupPubFilters();
      } catch {
        document.getElementById('pubsGrid').innerHTML =
          '<div class="empty">Failed to load. | [translate:ಲೋಡ್ ವಿಫಲವಾಗಿದೆ.]</div>';
      }
    }
    async function displayPosts(posts) {
      const grid = document.getElementById('pubsGrid');
      if (!posts || posts.length === 0) {
        grid.innerHTML = '<div class="empty">No publications found. | [translate:ಪ್ರಕಾಶನೆಗಳು ಸಿಗಲಿಲ್ಲ.]</div>';
        return;
      }
      const cards = await Promise.all(posts.map(async p => {
        const content = await loadContent(p.content);
        const title = lang === 'en' ? (p.title?.en || '') : (p.title?.ka || p.title?.en || '');
        const titleBi = `${p.title?.en || ''} | ${p.title?.ka || p.title?.en || ''}`;
        const pdf = p.pdf ? `<a href="${escapeHTML(p.pdf)}" class="btn" target="_blank" rel="noopener noreferrer">download PDF | [translate:PDF ಡೌನ್‌ಲೋಡ್]</a>` : '';
        const tags = p.tags ? `<div class="tags">${p.tags.map(t => `<span class="tag">${escapeHTML(t)}</span>`).join(' ')}</div>` : '';
        return `
          <div class="card" tabindex="0">
            <div class="card-title">${escapeHTML(titleBi)}</div>
            <div class="card-meta">${escapeHTML(p.author || '')} • ${escapeHTML(p.date || '')}</div>
            <div class="card-content">${escapeHTML(content)}</div>
            ${tags}
            ${pdf}
          </div>
        `;
      }));
      grid.innerHTML = cards.join('');
    }
    function setupPubFilters() {
      const tags = [...new Set((postsData || []).flatMap(p => p.tags || []))];
      const cont = document.getElementById('pubFilters');
      cont.innerHTML = tags.map(f => `<button class="filter-btn" data-f="${escapeHTML(f)}">${escapeHTML(f)}</button>`).join('');
      cont.querySelectorAll('.filter-btn').forEach(btn => {
        btn.onclick = () => {
          const f = btn.getAttribute('data-f');
          if (filters.pubs.has(f)) { filters.pubs.delete(f); btn.classList.remove('active'); }
          else { filters.pubs.add(f); btn.classList.add('active'); }
          filterPosts();
        };
      });
      document.getElementById('searchPubs').oninput = filterPosts;
    }
    function filterPosts() {
      const search = (document.getElementById('searchPubs').value || '').toLowerCase();
      const filtered = (postsData || []).filter(p => {
        const enTitle = (p.title?.en || '').toLowerCase();
        const kaTitle = (p.title?.ka || '').toLowerCase();
        const name = `${enTitle} ${kaTitle}`;
        const matchSearch = name.includes(search) || (p.author || '').toLowerCase().includes(search);
        const matchFilter = filters.pubs.size === 0 || (p.tags || []).some(t => filters.pubs.has(t));
        return matchSearch && matchFilter;
      });
      displayPosts(filtered);
    }
    async function loadModels() {
      try {
        const res = await fetch('data/models.json');
        const json = await res.json();
        modelsData = json.models || [];
        displayModels(modelsData);
        setupModelFilters();
      } catch {
        document.getElementById('modelsGrid').innerHTML =
          '<div class="empty">Failed to load. | [translate:ಲೋಡ್ ವಿಫಲವಾಗಿದೆ.]</div>';
      }
    }
    async function displayModels(models) {
      const grid = document.getElementById('modelsGrid');
      if (!models || models.length === 0) {
        grid.innerHTML = '<div class="empty">No models found. | [translate:ಮಾದರಿ ಸಿಗಲಿಲ್ಲ.]</div>';
        return;
      }
      const cards = await Promise.all(models.map(async m => {
        const content = await loadContent(m.content);
        const nameBi = `${m.name?.en || ''} | ${m.name?.ka || m.name?.en || ''}`;
        return `
          <div class="card" tabindex="0">
            <div class="card-title">${escapeHTML(nameBi)}</div>
            <div class="card-meta">${escapeHTML(m.version || '')} • ${escapeHTML(m.date || '')}</div>
            <div class="card-content">${escapeHTML(content)}</div>
            <div class="model-info">
              <div class="model-info-item">
                <span class="model-info-label">Framework</span>
                <span class="model-info-value">${escapeHTML(m.framework || '')}</span>
              </div>
              <div class="model-info-item">
                <span class="model-info-label">Type</span>
                <span class="model-info-value">${escapeHTML(m.fileType || '')}</span>
              </div>
              <div class="model-info-item">
                <span class="model-info-label">Size</span>
                <span class="model-info-value">${escapeHTML(m.fileSize || '')}</span>
              </div>
              <div class="model-info-item">
                <span class="model-info-label">Arch</span>
                <span class="model-info-value">${escapeHTML(m.architecture || '')}</span>
              </div>
            </div>
            ${m.downloadUrl ? `<a href="${escapeHTML(m.downloadUrl)}" class="btn" target="_blank" rel="noopener noreferrer">download | [translate:ಡೌನ್‌ಲೋಡ್]</a>` : ''}
          </div>
        `;
      }));
      grid.innerHTML = cards.join('');
    }
    function setupModelFilters() {
      const fws = [...new Set((modelsData || []).map(m => m.framework).filter(Boolean))];
      const cont = document.getElementById('modelFilters');
      cont.innerHTML = fws.map(f => `<button class="filter-btn" data-f="${escapeHTML(f)}">${escapeHTML(f)}</button>`).join('');
      cont.querySelectorAll('.filter-btn').forEach(btn => {
        btn.onclick = () => {
          const f = btn.getAttribute('data-f');
          if (filters.models.has(f)) { filters.models.delete(f); btn.classList.remove('active'); }
          else { filters.models.add(f); btn.classList.add('active'); }
          filterModels();
        };
      });
      document.getElementById('searchModels').oninput = filterModels;
    }
    function filterModels() {
      const search = (document.getElementById('searchModels').value || '').toLowerCase();
      const filtered = (modelsData || []).filter(m => {
        const en = (m.name?.en || '').toLowerCase();
        const ka = (m.name?.ka || '').toLowerCase();
        const name = `${en} ${ka}`;
        const matchSearch = name.includes(search) || (m.architecture || '').toLowerCase().includes(search);
        const matchFilter = filters.models.size === 0 || filters.models.has(m.framework);
        return matchSearch && matchFilter;
      });
      displayModels(filtered);
    }
    async function init() {
      applyLang(lang);
      await loadPosts();
      await loadModels();
    }
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>


